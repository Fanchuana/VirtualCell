INFO:state._cli._tx._predict:Loaded config from /work/home/cryoem666/czx/project/state_training_debug/experiment/ba_loss_01_13/model_output/rpe1/0.7_0.3/config.yaml
INFO:cell_load.data_modules.perturbation_dataloader:Loaded data module configuration from /work/home/cryoem666/czx/project/state_training_debug/experiment/ba_loss_01_13/model_output/rpe1/0.7_0.3/data_module.torch
INFO:cell_load.config:Configuration validation passed
INFO:cell_load.data_modules.perturbation_dataloader:Initializing DataModule: batch_size=64, workers=16, random_seed=42
INFO:cell_load.data_modules.perturbation_dataloader:Processing dataset replogle_proper:
INFO:cell_load.data_modules.perturbation_dataloader:  - Training dataset: True
INFO:cell_load.data_modules.perturbation_dataloader:  - Zeroshot cell types: []
INFO:cell_load.data_modules.perturbation_dataloader:  - Fewshot cell types: ['rpe1']
Processing replogle_proper:   0%|          | 0/1 [00:00<?, ?it/s]WARNING:cell_load.dataset._perturbation:No cell barcode information found in /work/home/cryoem666/xyf/temp/pycharm/state/gene_perturnb_state/data/replogle.h5ad. Generating generic barcodes.
                                                                 Processing replogle_proper:   0%|          | 0/1 [00:19<?, ?it/s]Processing replogle_proper: 100%|██████████| 1/1 [00:19<00:00, 19.99s/it]Processing replogle_proper: 100%|██████████| 1/1 [00:19<00:00, 19.99s/it]
INFO:cell_load.data_modules.perturbation_dataloader:

INFO:cell_load.data_modules.perturbation_dataloader:Done! Train / Val / Test splits: 4 / 1 / 1
INFO:state._cli._tx._predict:Loaded data module from /work/home/cryoem666/czx/project/state_training_debug/experiment/ba_loss_01_13/model_output/rpe1/0.7_0.3/data_module.torch
Seed set to 42
INFO:state._cli._tx._predict:Loading model from /work/home/cryoem666/czx/project/state_training_debug/experiment/ba_loss_01_13/model_output/rpe1/0.7_0.3/checkpoints/best.ckpt
INFO:state.tx.models.base:Loaded decoder from checkpoint decoder_cfg: {'latent_dim': 6642, 'gene_dim': 2000, 'hidden_dims': [1024, 1024, 512], 'dropout': 0.1, 'residual_decoder': False}
INFO:state._cli._tx._predict:Model loaded successfully.
INFO:cell_load.data_modules.samplers:Creating perturbation batch sampler with metadata caching (using codes)...
INFO:cell_load.data_modules.samplers:Total # cells 58114. Cell set size mean / std before resampling: 52.59 / 18.27.
INFO:cell_load.data_modules.samplers:Creating meta-batches with cell_sentence_len=64...
INFO:cell_load.data_modules.samplers:Of all batches, 1105 were full and 0 were partial.
INFO:cell_load.data_modules.samplers:Sampler created with 1105 batches in 0.05 seconds.
INFO:state._cli._tx._predict:Generating predictions on test set using manual loop...
Predicting:   0%|          | 0/1105 [00:00<?, ?batch/s]INFO:cell_load.data_modules.samplers:Of all batches, 1105 were full and 0 were partial.
Predicting:   0%|          | 1/1105 [00:04<1:17:11,  4.20s/batch]Predicting:   0%|          | 2/1105 [00:04<32:55,  1.79s/batch]  Predicting:   0%|          | 4/1105 [00:04<13:04,  1.40batch/s]Predicting:   1%|          | 6/1105 [00:04<07:22,  2.48batch/s]Predicting:   1%|          | 9/1105 [00:04<04:07,  4.42batch/s]Predicting:   1%|          | 11/1105 [00:04<03:04,  5.91batch/s]Predicting:   1%|          | 13/1105 [00:05<02:39,  6.86batch/s]Predicting:   1%|▏         | 15/1105 [00:05<02:08,  8.45batch/s]Predicting:   2%|▏         | 17/1105 [00:05<01:46, 10.21batch/s]Predicting:   2%|▏         | 19/1105 [00:05<01:31, 11.87batch/s]Predicting:   2%|▏         | 22/1105 [00:05<01:15, 14.27batch/s]Predicting:   2%|▏         | 25/1105 [00:05<01:06, 16.17batch/s]Predicting:   3%|▎         | 28/1105 [00:05<01:01, 17.43batch/s]Predicting:   3%|▎         | 31/1105 [00:05<00:58, 18.40batch/s]Predicting:   3%|▎         | 33/1105 [00:06<00:58, 18.21batch/s]Predicting:   3%|▎         | 35/1105 [00:06<00:57, 18.60batch/s]Predicting:   3%|▎         | 38/1105 [00:06<00:55, 19.09batch/s]Predicting:   4%|▎         | 40/1105 [00:06<00:56, 18.86batch/s]Predicting:   4%|▍         | 43/1105 [00:06<00:54, 19.54batch/s]Predicting:   4%|▍         | 45/1105 [00:06<00:54, 19.45batch/s]Predicting:   4%|▍         | 48/1105 [00:06<00:53, 19.58batch/s]Predicting:   5%|▍         | 50/1105 [00:06<00:54, 19.29batch/s]Predicting:   5%|▍         | 53/1105 [00:07<00:52, 19.98batch/s]Predicting:   5%|▍         | 55/1105 [00:07<00:53, 19.81batch/s]Predicting:   5%|▌         | 57/1105 [00:07<00:53, 19.58batch/s]Predicting:   5%|▌         | 59/1105 [00:07<00:53, 19.56batch/s]Predicting:   6%|▌         | 61/1105 [00:07<00:53, 19.47batch/s]Predicting:   6%|▌         | 64/1105 [00:07<00:52, 19.74batch/s]Predicting:   6%|▌         | 66/1105 [00:07<00:54, 19.06batch/s]Predicting:   6%|▌         | 68/1105 [00:07<00:54, 19.13batch/s]Predicting:   6%|▋         | 71/1105 [00:07<00:52, 19.78batch/s]Predicting:   7%|▋         | 73/1105 [00:08<00:54, 18.81batch/s]Predicting:   7%|▋         | 75/1105 [00:08<00:55, 18.71batch/s]Predicting:   7%|▋         | 77/1105 [00:08<00:54, 18.86batch/s]Predicting:   7%|▋         | 79/1105 [00:08<00:53, 19.03batch/s]Predicting:   7%|▋         | 81/1105 [00:08<00:57, 17.86batch/s]Predicting:   8%|▊         | 83/1105 [00:08<00:56, 18.20batch/s]Predicting:   8%|▊         | 86/1105 [00:08<00:55, 18.26batch/s]Predicting:   8%|▊         | 89/1105 [00:08<00:54, 18.73batch/s]Predicting:   8%|▊         | 91/1105 [00:09<00:57, 17.67batch/s]Predicting:   8%|▊         | 93/1105 [00:09<00:56, 17.93batch/s]Predicting:   9%|▊         | 95/1105 [00:09<00:54, 18.37batch/s]Predicting:   9%|▉         | 97/1105 [00:09<00:54, 18.37batch/s]Predicting:   9%|▉         | 99/1105 [00:09<00:54, 18.54batch/s]Predicting:   9%|▉         | 101/1105 [00:09<00:53, 18.67batch/s]Predicting:   9%|▉         | 103/1105 [00:09<00:53, 18.76batch/s]Predicting:  10%|▉         | 105/1105 [00:09<00:54, 18.45batch/s]Predicting:  10%|▉         | 107/1105 [00:09<00:53, 18.59batch/s]Predicting:  10%|▉         | 109/1105 [00:10<00:53, 18.68batch/s]Predicting:  10%|█         | 112/1105 [00:10<00:52, 19.03batch/s]Predicting:  10%|█         | 114/1105 [00:10<00:51, 19.24batch/s]Predicting:  10%|█         | 116/1105 [00:10<00:51, 19.23batch/s]Predicting:  11%|█         | 118/1105 [00:10<00:52, 18.62batch/s]Predicting:  11%|█         | 121/1105 [00:10<00:51, 19.14batch/s]Predicting:  11%|█         | 123/1105 [00:10<00:51, 19.17batch/s]Predicting:  11%|█▏        | 125/1105 [00:10<00:50, 19.25batch/s]Predicting:  11%|█▏        | 127/1105 [00:10<00:51, 19.00batch/s]Predicting:  12%|█▏        | 129/1105 [00:11<00:51, 18.92batch/s]Predicting:  12%|█▏        | 131/1105 [00:11<00:51, 18.74batch/s]Predicting:  12%|█▏        | 134/1105 [00:11<00:49, 19.47batch/s]Predicting:  12%|█▏        | 136/1105 [00:11<00:49, 19.46batch/s]Predicting:  13%|█▎        | 139/1105 [00:11<00:48, 19.85batch/s]Predicting:  13%|█▎        | 141/1105 [00:11<00:51, 18.79batch/s]Predicting:  13%|█▎        | 143/1105 [00:11<00:51, 18.67batch/s]Predicting:  13%|█▎        | 145/1105 [00:11<00:55, 17.42batch/s]Predicting:  13%|█▎        | 148/1105 [00:12<00:52, 18.31batch/s]Predicting:  14%|█▎        | 150/1105 [00:12<00:51, 18.48batch/s]Predicting:  14%|█▍        | 153/1105 [00:12<00:51, 18.51batch/s]Predicting:  14%|█▍        | 155/1105 [00:12<00:52, 18.14batch/s]Predicting:  14%|█▍        | 158/1105 [00:12<00:49, 19.20batch/s]Predicting:  14%|█▍        | 160/1105 [00:12<00:51, 18.26batch/s]Predicting:  15%|█▍        | 162/1105 [00:12<00:50, 18.64batch/s]Predicting:  15%|█▍        | 164/1105 [00:12<00:50, 18.81batch/s]Predicting:  15%|█▌        | 167/1105 [00:13<00:47, 19.78batch/s]Predicting:  15%|█▌        | 169/1105 [00:13<00:48, 19.30batch/s]Predicting:  16%|█▌        | 172/1105 [00:13<00:47, 19.49batch/s]Predicting:  16%|█▌        | 175/1105 [00:13<00:46, 20.00batch/s]Predicting:  16%|█▌        | 178/1105 [00:13<00:46, 20.01batch/s]Predicting:  16%|█▋        | 180/1105 [00:13<00:46, 19.84batch/s]Predicting:  17%|█▋        | 183/1105 [00:13<00:46, 20.03batch/s]Predicting:  17%|█▋        | 185/1105 [00:13<00:46, 19.92batch/s]Predicting:  17%|█▋        | 187/1105 [00:14<00:46, 19.60batch/s]Predicting:  17%|█▋        | 189/1105 [00:14<00:46, 19.55batch/s]Predicting:  17%|█▋        | 192/1105 [00:14<00:45, 19.92batch/s]Predicting:  18%|█▊        | 194/1105 [00:14<00:46, 19.57batch/s]Predicting:  18%|█▊        | 197/1105 [00:14<00:45, 20.00batch/s]Predicting:  18%|█▊        | 199/1105 [00:14<00:45, 19.75batch/s]Predicting:  18%|█▊        | 202/1105 [00:14<00:45, 19.89batch/s]Predicting:  19%|█▊        | 205/1105 [00:15<00:45, 19.79batch/s]Predicting:  19%|█▊        | 207/1105 [00:15<00:45, 19.56batch/s]Predicting:  19%|█▉        | 209/1105 [00:15<00:45, 19.53batch/s]Predicting:  19%|█▉        | 211/1105 [00:15<00:46, 19.12batch/s]Predicting:  19%|█▉        | 213/1105 [00:15<00:47, 18.97batch/s]Predicting:  20%|█▉        | 216/1105 [00:15<00:45, 19.42batch/s]Predicting:  20%|█▉        | 218/1105 [00:15<00:46, 18.92batch/s]Predicting:  20%|█▉        | 220/1105 [00:15<00:46, 19.06batch/s]Predicting:  20%|██        | 223/1105 [00:15<00:44, 19.97batch/s]Predicting:  20%|██        | 226/1105 [00:16<00:44, 19.92batch/s]Predicting:  21%|██        | 229/1105 [00:16<00:43, 20.31batch/s]Predicting:  21%|██        | 232/1105 [00:16<00:43, 19.89batch/s]Predicting:  21%|██▏       | 235/1105 [00:16<00:44, 19.69batch/s]Predicting:  22%|██▏       | 238/1105 [00:16<00:42, 20.21batch/s]Predicting:  22%|██▏       | 241/1105 [00:16<00:43, 19.84batch/s]Predicting:  22%|██▏       | 244/1105 [00:16<00:43, 19.69batch/s]Predicting:  22%|██▏       | 246/1105 [00:17<00:43, 19.71batch/s]Predicting:  22%|██▏       | 248/1105 [00:17<00:43, 19.60batch/s]Predicting:  23%|██▎       | 251/1105 [00:17<00:42, 20.16batch/s]Predicting:  23%|██▎       | 254/1105 [00:17<00:42, 20.00batch/s]Predicting:  23%|██▎       | 256/1105 [00:17<00:42, 19.85batch/s]Predicting:  23%|██▎       | 258/1105 [00:17<00:43, 19.64batch/s]Predicting:  24%|██▎       | 260/1105 [00:17<00:43, 19.43batch/s]Predicting:  24%|██▍       | 263/1105 [00:17<00:41, 20.15batch/s]Predicting:  24%|██▍       | 266/1105 [00:18<00:41, 20.07batch/s]Predicting:  24%|██▍       | 268/1105 [00:18<00:42, 19.87batch/s]Predicting:  24%|██▍       | 270/1105 [00:18<00:42, 19.52batch/s]Predicting:  25%|██▍       | 272/1105 [00:18<00:42, 19.62batch/s]Predicting:  25%|██▍       | 274/1105 [00:18<00:42, 19.69batch/s]Predicting:  25%|██▌       | 277/1105 [00:18<00:41, 19.89batch/s]Predicting:  25%|██▌       | 279/1105 [00:18<00:41, 19.89batch/s]Predicting:  26%|██▌       | 282/1105 [00:18<00:41, 19.79batch/s]Predicting:  26%|██▌       | 284/1105 [00:19<00:41, 19.80batch/s]Predicting:  26%|██▌       | 286/1105 [00:19<00:42, 19.16batch/s]Predicting:  26%|██▌       | 289/1105 [00:19<00:40, 19.97batch/s]Predicting:  26%|██▋       | 292/1105 [00:19<00:40, 19.85batch/s]Predicting:  27%|██▋       | 294/1105 [00:19<00:40, 19.83batch/s]Predicting:  27%|██▋       | 296/1105 [00:19<00:41, 19.58batch/s]Predicting:  27%|██▋       | 299/1105 [00:19<00:40, 19.83batch/s]Predicting:  27%|██▋       | 301/1105 [00:19<00:40, 19.78batch/s]Predicting:  27%|██▋       | 303/1105 [00:19<00:41, 19.52batch/s]Predicting:  28%|██▊       | 306/1105 [00:20<00:40, 19.82batch/s]Predicting:  28%|██▊       | 309/1105 [00:20<00:39, 20.23batch/s]Predicting:  28%|██▊       | 312/1105 [00:20<00:39, 20.18batch/s]Predicting:  29%|██▊       | 315/1105 [00:20<00:38, 20.72batch/s]Predicting:  29%|██▉       | 318/1105 [00:20<00:38, 20.51batch/s]Predicting:  29%|██▉       | 321/1105 [00:20<00:38, 20.14batch/s]Predicting:  29%|██▉       | 324/1105 [00:21<00:38, 20.22batch/s]Predicting:  30%|██▉       | 327/1105 [00:21<00:38, 20.05batch/s]Predicting:  30%|██▉       | 330/1105 [00:21<00:38, 20.24batch/s]Predicting:  30%|███       | 333/1105 [00:21<00:38, 20.15batch/s]Predicting:  30%|███       | 336/1105 [00:21<00:36, 20.98batch/s]Predicting:  31%|███       | 339/1105 [00:21<00:36, 20.87batch/s]Predicting:  31%|███       | 342/1105 [00:21<00:36, 20.65batch/s]Predicting:  31%|███       | 345/1105 [00:22<00:37, 20.09batch/s]Predicting:  31%|███▏      | 348/1105 [00:22<00:37, 20.16batch/s]Predicting:  32%|███▏      | 351/1105 [00:22<00:36, 20.61batch/s]Predicting:  32%|███▏      | 354/1105 [00:22<00:36, 20.33batch/s]Predicting:  32%|███▏      | 357/1105 [00:22<00:37, 20.15batch/s]Predicting:  33%|███▎      | 360/1105 [00:22<00:36, 20.24batch/s]Predicting:  33%|███▎      | 363/1105 [00:22<00:36, 20.36batch/s]Predicting:  33%|███▎      | 366/1105 [00:23<00:36, 20.09batch/s]Predicting:  33%|███▎      | 369/1105 [00:23<00:37, 19.81batch/s]Predicting:  34%|███▎      | 372/1105 [00:23<00:36, 20.20batch/s]Predicting:  34%|███▍      | 375/1105 [00:23<00:36, 20.16batch/s]Predicting:  34%|███▍      | 378/1105 [00:23<00:35, 20.22batch/s]Predicting:  34%|███▍      | 381/1105 [00:23<00:36, 19.97batch/s]Predicting:  35%|███▍      | 384/1105 [00:23<00:36, 19.91batch/s]Predicting:  35%|███▌      | 387/1105 [00:24<00:35, 20.12batch/s]Predicting:  35%|███▌      | 390/1105 [00:24<00:35, 20.17batch/s]Predicting:  36%|███▌      | 393/1105 [00:24<00:35, 19.97batch/s]Predicting:  36%|███▌      | 395/1105 [00:24<00:35, 19.95batch/s]Predicting:  36%|███▌      | 398/1105 [00:24<00:35, 19.79batch/s]Predicting:  36%|███▋      | 401/1105 [00:24<00:35, 19.96batch/s]Predicting:  37%|███▋      | 404/1105 [00:24<00:34, 20.05batch/s]Predicting:  37%|███▋      | 407/1105 [00:25<00:34, 20.12batch/s]Predicting:  37%|███▋      | 410/1105 [00:25<00:34, 20.10batch/s]Predicting:  37%|███▋      | 413/1105 [00:25<00:33, 20.50batch/s]Predicting:  38%|███▊      | 416/1105 [00:25<00:34, 20.24batch/s]Predicting:  38%|███▊      | 419/1105 [00:25<00:34, 19.97batch/s]Predicting:  38%|███▊      | 422/1105 [00:25<00:34, 20.06batch/s]Predicting:  38%|███▊      | 425/1105 [00:26<00:33, 20.30batch/s]Predicting:  39%|███▊      | 428/1105 [00:26<00:33, 20.32batch/s]Predicting:  39%|███▉      | 431/1105 [00:26<00:33, 20.31batch/s]Predicting:  39%|███▉      | 434/1105 [00:26<00:32, 20.42batch/s]Predicting:  40%|███▉      | 437/1105 [00:26<00:33, 20.16batch/s]Predicting:  40%|███▉      | 440/1105 [00:26<00:32, 20.16batch/s]Predicting:  40%|████      | 443/1105 [00:26<00:32, 20.37batch/s]Predicting:  40%|████      | 446/1105 [00:27<00:32, 20.34batch/s]Predicting:  41%|████      | 449/1105 [00:27<00:32, 20.30batch/s]Predicting:  41%|████      | 452/1105 [00:27<00:32, 20.22batch/s]Predicting:  41%|████      | 455/1105 [00:27<00:31, 20.54batch/s]Predicting:  41%|████▏     | 458/1105 [00:27<00:31, 20.52batch/s]Predicting:  42%|████▏     | 461/1105 [00:27<00:31, 20.35batch/s]Predicting:  42%|████▏     | 464/1105 [00:27<00:31, 20.32batch/s]Predicting:  42%|████▏     | 467/1105 [00:28<00:31, 20.11batch/s]Predicting:  43%|████▎     | 470/1105 [00:28<00:31, 20.26batch/s]Predicting:  43%|████▎     | 473/1105 [00:28<00:31, 20.37batch/s]Predicting:  43%|████▎     | 476/1105 [00:28<00:30, 20.54batch/s]Predicting:  43%|████▎     | 479/1105 [00:28<00:30, 20.63batch/s]Predicting:  44%|████▎     | 482/1105 [00:28<00:30, 20.59batch/s]Predicting:  44%|████▍     | 485/1105 [00:28<00:30, 20.45batch/s]Predicting:  44%|████▍     | 488/1105 [00:29<00:30, 20.05batch/s]Predicting:  44%|████▍     | 491/1105 [00:29<00:30, 19.93batch/s]Predicting:  45%|████▍     | 494/1105 [00:29<00:30, 20.14batch/s]Predicting:  45%|████▍     | 497/1105 [00:29<00:30, 20.05batch/s]Predicting:  45%|████▌     | 500/1105 [00:29<00:30, 20.09batch/s]Predicting:  46%|████▌     | 503/1105 [00:29<00:29, 20.11batch/s]Predicting:  46%|████▌     | 506/1105 [00:30<00:30, 19.91batch/s]Predicting:  46%|████▌     | 509/1105 [00:30<00:29, 20.17batch/s]Predicting:  46%|████▋     | 512/1105 [00:30<00:28, 20.57batch/s]Predicting:  47%|████▋     | 515/1105 [00:30<00:28, 20.47batch/s]Predicting:  47%|████▋     | 518/1105 [00:30<00:29, 19.77batch/s]Predicting:  47%|████▋     | 521/1105 [00:30<00:29, 20.11batch/s]Predicting:  47%|████▋     | 524/1105 [00:30<00:30, 19.08batch/s]Predicting:  48%|████▊     | 526/1105 [00:31<00:30, 19.07batch/s]Predicting:  48%|████▊     | 528/1105 [00:31<00:30, 19.21batch/s]Predicting:  48%|████▊     | 530/1105 [00:31<00:29, 19.24batch/s]Predicting:  48%|████▊     | 533/1105 [00:31<00:29, 19.49batch/s]Predicting:  49%|████▊     | 536/1105 [00:31<00:28, 20.24batch/s]Predicting:  49%|████▉     | 539/1105 [00:31<00:27, 20.55batch/s]Predicting:  49%|████▉     | 542/1105 [00:31<00:28, 19.84batch/s]Predicting:  49%|████▉     | 545/1105 [00:31<00:27, 20.22batch/s]Predicting:  50%|████▉     | 548/1105 [00:32<00:27, 20.31batch/s]Predicting:  50%|████▉     | 551/1105 [00:32<00:27, 20.19batch/s]Predicting:  50%|█████     | 554/1105 [00:32<00:27, 20.01batch/s]Predicting:  50%|█████     | 557/1105 [00:32<00:27, 19.58batch/s]Predicting:  51%|█████     | 560/1105 [00:32<00:26, 20.31batch/s]Predicting:  51%|█████     | 563/1105 [00:32<00:25, 20.93batch/s]Predicting:  51%|█████     | 566/1105 [00:32<00:25, 21.10batch/s]Predicting:  51%|█████▏    | 569/1105 [00:33<00:26, 20.28batch/s]Predicting:  52%|█████▏    | 572/1105 [00:33<00:26, 20.47batch/s]Predicting:  52%|█████▏    | 575/1105 [00:33<00:25, 20.61batch/s]Predicting:  52%|█████▏    | 578/1105 [00:33<00:25, 20.79batch/s]Predicting:  53%|█████▎    | 581/1105 [00:33<00:25, 20.54batch/s]Predicting:  53%|█████▎    | 584/1105 [00:33<00:25, 20.42batch/s]Predicting:  53%|█████▎    | 587/1105 [00:34<00:25, 20.35batch/s]Predicting:  53%|█████▎    | 590/1105 [00:34<00:25, 20.58batch/s]Predicting:  54%|█████▎    | 593/1105 [00:34<00:24, 20.71batch/s]Predicting:  54%|█████▍    | 596/1105 [00:34<00:24, 20.50batch/s]Predicting:  54%|█████▍    | 599/1105 [00:34<00:25, 20.04batch/s]Predicting:  54%|█████▍    | 602/1105 [00:34<00:24, 20.27batch/s]Predicting:  55%|█████▍    | 605/1105 [00:34<00:24, 20.36batch/s]Predicting:  55%|█████▌    | 608/1105 [00:35<00:24, 20.43batch/s]Predicting:  55%|█████▌    | 611/1105 [00:35<00:23, 20.74batch/s]Predicting:  56%|█████▌    | 614/1105 [00:35<00:24, 20.45batch/s]Predicting:  56%|█████▌    | 617/1105 [00:35<00:23, 20.62batch/s]Predicting:  56%|█████▌    | 620/1105 [00:35<00:23, 20.79batch/s]Predicting:  56%|█████▋    | 623/1105 [00:35<00:24, 20.08batch/s]Predicting:  57%|█████▋    | 626/1105 [00:35<00:23, 20.28batch/s]Predicting:  57%|█████▋    | 629/1105 [00:36<00:24, 19.74batch/s]Predicting:  57%|█████▋    | 632/1105 [00:36<00:23, 19.85batch/s]Predicting:  57%|█████▋    | 635/1105 [00:36<00:23, 20.08batch/s]Predicting:  58%|█████▊    | 638/1105 [00:36<00:22, 20.40batch/s]Predicting:  58%|█████▊    | 641/1105 [00:36<00:22, 20.36batch/s]Predicting:  58%|█████▊    | 644/1105 [00:36<00:22, 20.42batch/s]Predicting:  59%|█████▊    | 647/1105 [00:36<00:22, 20.54batch/s]Predicting:  59%|█████▉    | 650/1105 [00:37<00:22, 20.44batch/s]Predicting:  59%|█████▉    | 653/1105 [00:37<00:22, 20.14batch/s]Predicting:  59%|█████▉    | 656/1105 [00:37<00:22, 20.15batch/s]Predicting:  60%|█████▉    | 659/1105 [00:37<00:22, 20.07batch/s]Predicting:  60%|█████▉    | 662/1105 [00:37<00:21, 20.44batch/s]Predicting:  60%|██████    | 665/1105 [00:37<00:21, 20.47batch/s]Predicting:  60%|██████    | 668/1105 [00:38<00:21, 20.42batch/s]Predicting:  61%|██████    | 671/1105 [00:38<00:21, 20.19batch/s]Predicting:  61%|██████    | 674/1105 [00:38<00:21, 20.47batch/s]Predicting:  61%|██████▏   | 677/1105 [00:38<00:21, 20.36batch/s]Predicting:  62%|██████▏   | 680/1105 [00:38<00:21, 19.93batch/s]Predicting:  62%|██████▏   | 683/1105 [00:38<00:20, 20.21batch/s]Predicting:  62%|██████▏   | 686/1105 [00:38<00:20, 20.28batch/s]Predicting:  62%|██████▏   | 689/1105 [00:39<00:21, 19.77batch/s]Predicting:  63%|██████▎   | 692/1105 [00:39<00:20, 20.17batch/s]Predicting:  63%|██████▎   | 695/1105 [00:39<00:20, 20.20batch/s]Predicting:  63%|██████▎   | 698/1105 [00:39<00:20, 20.14batch/s]Predicting:  63%|██████▎   | 701/1105 [00:39<00:19, 20.21batch/s]Predicting:  64%|██████▎   | 704/1105 [00:39<00:19, 20.23batch/s]Predicting:  64%|██████▍   | 707/1105 [00:39<00:20, 19.85batch/s]Predicting:  64%|██████▍   | 709/1105 [00:40<00:20, 19.70batch/s]Predicting:  64%|██████▍   | 712/1105 [00:40<00:19, 20.43batch/s]Predicting:  65%|██████▍   | 715/1105 [00:40<00:19, 20.40batch/s]Predicting:  65%|██████▍   | 718/1105 [00:40<00:18, 20.66batch/s]Predicting:  65%|██████▌   | 721/1105 [00:40<00:18, 20.91batch/s]Predicting:  66%|██████▌   | 724/1105 [00:40<00:18, 20.26batch/s]Predicting:  66%|██████▌   | 727/1105 [00:40<00:18, 20.22batch/s]Predicting:  66%|██████▌   | 730/1105 [00:41<00:18, 20.16batch/s]Predicting:  66%|██████▋   | 733/1105 [00:41<00:18, 20.08batch/s]Predicting:  67%|██████▋   | 736/1105 [00:41<00:18, 20.01batch/s]Predicting:  67%|██████▋   | 739/1105 [00:41<00:18, 20.12batch/s]Predicting:  67%|██████▋   | 742/1105 [00:41<00:18, 19.99batch/s]Predicting:  67%|██████▋   | 745/1105 [00:41<00:17, 20.28batch/s]Predicting:  68%|██████▊   | 748/1105 [00:41<00:18, 19.69batch/s]Predicting:  68%|██████▊   | 751/1105 [00:42<00:17, 20.18batch/s]Predicting:  68%|██████▊   | 754/1105 [00:42<00:17, 20.47batch/s]Predicting:  69%|██████▊   | 757/1105 [00:42<00:16, 20.48batch/s]Predicting:  69%|██████▉   | 760/1105 [00:42<00:17, 20.21batch/s]Predicting:  69%|██████▉   | 763/1105 [00:42<00:17, 19.98batch/s]Predicting:  69%|██████▉   | 766/1105 [00:42<00:16, 20.07batch/s]Predicting:  70%|██████▉   | 769/1105 [00:43<00:16, 20.27batch/s]Predicting:  70%|██████▉   | 772/1105 [00:43<00:16, 20.52batch/s]Predicting:  70%|███████   | 775/1105 [00:43<00:16, 20.05batch/s]Predicting:  70%|███████   | 778/1105 [00:43<00:16, 20.16batch/s]Predicting:  71%|███████   | 781/1105 [00:43<00:16, 20.22batch/s]Predicting:  71%|███████   | 784/1105 [00:43<00:15, 20.36batch/s]Predicting:  71%|███████   | 787/1105 [00:43<00:15, 20.01batch/s]Predicting:  71%|███████▏  | 790/1105 [00:44<00:15, 20.16batch/s]Predicting:  72%|███████▏  | 793/1105 [00:44<00:15, 20.32batch/s]Predicting:  72%|███████▏  | 796/1105 [00:44<00:15, 20.25batch/s]Predicting:  72%|███████▏  | 799/1105 [00:44<00:15, 20.16batch/s]Predicting:  73%|███████▎  | 802/1105 [00:44<00:15, 20.02batch/s]Predicting:  73%|███████▎  | 805/1105 [00:44<00:15, 19.95batch/s]Predicting:  73%|███████▎  | 807/1105 [00:44<00:15, 19.84batch/s]Predicting:  73%|███████▎  | 810/1105 [00:45<00:14, 20.39batch/s]Predicting:  74%|███████▎  | 813/1105 [00:45<00:14, 20.48batch/s]Predicting:  74%|███████▍  | 816/1105 [00:45<00:13, 20.69batch/s]Predicting:  74%|███████▍  | 819/1105 [00:45<00:13, 20.96batch/s]Predicting:  74%|███████▍  | 822/1105 [00:45<00:13, 20.59batch/s]Predicting:  75%|███████▍  | 825/1105 [00:45<00:13, 20.14batch/s]Predicting:  75%|███████▍  | 828/1105 [00:45<00:13, 20.26batch/s]Predicting:  75%|███████▌  | 831/1105 [00:46<00:13, 19.98batch/s]Predicting:  75%|███████▌  | 834/1105 [00:46<00:13, 19.86batch/s]Predicting:  76%|███████▌  | 837/1105 [00:46<00:13, 20.24batch/s]Predicting:  76%|███████▌  | 840/1105 [00:46<00:13, 20.12batch/s]Predicting:  76%|███████▋  | 843/1105 [00:46<00:12, 20.31batch/s]Predicting:  77%|███████▋  | 846/1105 [00:46<00:12, 20.17batch/s]Predicting:  77%|███████▋  | 849/1105 [00:46<00:12, 20.00batch/s]Predicting:  77%|███████▋  | 852/1105 [00:47<00:12, 19.92batch/s]Predicting:  77%|███████▋  | 855/1105 [00:47<00:12, 20.64batch/s]Predicting:  78%|███████▊  | 858/1105 [00:47<00:12, 20.35batch/s]Predicting:  78%|███████▊  | 861/1105 [00:47<00:12, 20.15batch/s]Predicting:  78%|███████▊  | 864/1105 [00:47<00:11, 20.32batch/s]Predicting:  78%|███████▊  | 867/1105 [00:47<00:11, 20.00batch/s]Predicting:  79%|███████▊  | 870/1105 [00:48<00:11, 20.13batch/s]Predicting:  79%|███████▉  | 873/1105 [00:48<00:11, 20.49batch/s]Predicting:  79%|███████▉  | 876/1105 [00:48<00:11, 20.40batch/s]Predicting:  80%|███████▉  | 879/1105 [00:48<00:11, 20.02batch/s]Predicting:  80%|███████▉  | 882/1105 [00:48<00:11, 20.23batch/s]Predicting:  80%|████████  | 885/1105 [00:48<00:10, 20.19batch/s]Predicting:  80%|████████  | 888/1105 [00:48<00:10, 20.10batch/s]Predicting:  81%|████████  | 891/1105 [00:49<00:10, 19.81batch/s]Predicting:  81%|████████  | 893/1105 [00:49<00:10, 19.81batch/s]Predicting:  81%|████████  | 896/1105 [00:49<00:10, 20.14batch/s]Predicting:  81%|████████▏ | 899/1105 [00:49<00:10, 20.49batch/s]Predicting:  82%|████████▏ | 902/1105 [00:49<00:09, 20.90batch/s]Predicting:  82%|████████▏ | 905/1105 [00:49<00:09, 20.31batch/s]Predicting:  82%|████████▏ | 908/1105 [00:49<00:09, 20.46batch/s]Predicting:  82%|████████▏ | 911/1105 [00:50<00:09, 20.65batch/s]Predicting:  83%|████████▎ | 914/1105 [00:50<00:09, 20.90batch/s]Predicting:  83%|████████▎ | 917/1105 [00:50<00:09, 20.52batch/s]Predicting:  83%|████████▎ | 920/1105 [00:50<00:09, 20.24batch/s]Predicting:  84%|████████▎ | 923/1105 [00:50<00:08, 20.49batch/s]Predicting:  84%|████████▍ | 926/1105 [00:50<00:08, 20.75batch/s]Predicting:  84%|████████▍ | 929/1105 [00:50<00:08, 20.70batch/s]Predicting:  84%|████████▍ | 932/1105 [00:51<00:08, 20.82batch/s]Predicting:  85%|████████▍ | 935/1105 [00:51<00:08, 20.80batch/s]Predicting:  85%|████████▍ | 938/1105 [00:51<00:08, 20.81batch/s]Predicting:  85%|████████▌ | 941/1105 [00:51<00:07, 21.00batch/s]Predicting:  85%|████████▌ | 944/1105 [00:51<00:07, 20.69batch/s]Predicting:  86%|████████▌ | 947/1105 [00:51<00:07, 20.74batch/s]Predicting:  86%|████████▌ | 950/1105 [00:51<00:07, 20.25batch/s]Predicting:  86%|████████▌ | 953/1105 [00:52<00:07, 20.63batch/s]Predicting:  87%|████████▋ | 956/1105 [00:52<00:07, 20.76batch/s]Predicting:  87%|████████▋ | 959/1105 [00:52<00:07, 20.69batch/s]Predicting:  87%|████████▋ | 962/1105 [00:52<00:06, 21.05batch/s]Predicting:  87%|████████▋ | 965/1105 [00:52<00:06, 20.91batch/s]Predicting:  88%|████████▊ | 968/1105 [00:52<00:06, 20.88batch/s]Predicting:  88%|████████▊ | 971/1105 [00:52<00:06, 21.00batch/s]Predicting:  88%|████████▊ | 974/1105 [00:53<00:06, 21.27batch/s]Predicting:  88%|████████▊ | 977/1105 [00:53<00:06, 20.91batch/s]Predicting:  89%|████████▊ | 980/1105 [00:53<00:06, 20.28batch/s]Predicting:  89%|████████▉ | 983/1105 [00:53<00:05, 20.74batch/s]Predicting:  89%|████████▉ | 986/1105 [00:53<00:05, 20.69batch/s]Predicting:  90%|████████▉ | 989/1105 [00:53<00:05, 20.78batch/s]Predicting:  90%|████████▉ | 992/1105 [00:53<00:05, 20.40batch/s]Predicting:  90%|█████████ | 995/1105 [00:54<00:05, 20.30batch/s]Predicting:  90%|█████████ | 998/1105 [00:54<00:05, 20.39batch/s]Predicting:  91%|█████████ | 1001/1105 [00:54<00:05, 20.29batch/s]Predicting:  91%|█████████ | 1004/1105 [00:54<00:05, 20.06batch/s]Predicting:  91%|█████████ | 1007/1105 [00:54<00:04, 20.07batch/s]Predicting:  91%|█████████▏| 1010/1105 [00:54<00:04, 20.42batch/s]Predicting:  92%|█████████▏| 1013/1105 [00:54<00:04, 20.32batch/s]Predicting:  92%|█████████▏| 1016/1105 [00:55<00:04, 20.17batch/s]Predicting:  92%|█████████▏| 1019/1105 [00:55<00:04, 20.70batch/s]Predicting:  92%|█████████▏| 1022/1105 [00:55<00:04, 20.36batch/s]Predicting:  93%|█████████▎| 1025/1105 [00:55<00:03, 20.40batch/s]Predicting:  93%|█████████▎| 1028/1105 [00:55<00:03, 20.42batch/s]Predicting:  93%|█████████▎| 1031/1105 [00:55<00:03, 20.34batch/s]Predicting:  94%|█████████▎| 1034/1105 [00:55<00:03, 20.39batch/s]Predicting:  94%|█████████▍| 1037/1105 [00:56<00:03, 20.84batch/s]Predicting:  94%|█████████▍| 1040/1105 [00:56<00:03, 20.78batch/s]Predicting:  94%|█████████▍| 1043/1105 [00:56<00:02, 20.70batch/s]Predicting:  95%|█████████▍| 1046/1105 [00:56<00:02, 20.79batch/s]Predicting:  95%|█████████▍| 1049/1105 [00:56<00:02, 20.49batch/s]Predicting:  95%|█████████▌| 1052/1105 [00:56<00:02, 20.83batch/s]Predicting:  95%|█████████▌| 1055/1105 [00:57<00:02, 20.42batch/s]Predicting:  96%|█████████▌| 1058/1105 [00:57<00:02, 20.52batch/s]Predicting:  96%|█████████▌| 1061/1105 [00:57<00:02, 20.59batch/s]Predicting:  96%|█████████▋| 1064/1105 [00:57<00:01, 20.94batch/s]Predicting:  97%|█████████▋| 1067/1105 [00:57<00:01, 21.13batch/s]Predicting:  97%|█████████▋| 1070/1105 [00:57<00:01, 21.07batch/s]Predicting:  97%|█████████▋| 1073/1105 [00:57<00:01, 20.78batch/s]Predicting:  97%|█████████▋| 1076/1105 [00:58<00:01, 20.66batch/s]Predicting:  98%|█████████▊| 1079/1105 [00:58<00:01, 21.40batch/s]Predicting:  98%|█████████▊| 1082/1105 [00:58<00:01, 21.85batch/s]Predicting:  98%|█████████▊| 1085/1105 [00:58<00:00, 22.40batch/s]Predicting:  98%|█████████▊| 1088/1105 [00:58<00:00, 22.63batch/s]Predicting:  99%|█████████▊| 1091/1105 [00:58<00:00, 22.94batch/s]Predicting:  99%|█████████▉| 1094/1105 [00:58<00:00, 23.00batch/s]Predicting:  99%|█████████▉| 1097/1105 [00:58<00:00, 22.94batch/s]Predicting: 100%|█████████▉| 1100/1105 [00:59<00:00, 22.74batch/s]Predicting: 100%|█████████▉| 1103/1105 [00:59<00:00, 22.70batch/s]Predicting: 100%|██████████| 1105/1105 [00:59<00:00, 18.57batch/s]
INFO:state._cli._tx._predict:Creating anndatas from predictions from manual loop...
INFO:state._cli._tx._predict:Clipped adata_pred and adata_real X values to [0.0, 14.0] before evaluation.
... storing 'gene' as categorical
... storing 'cell_line' as categorical
... storing 'gem_group' as categorical
... storing 'ctrl_cell_barcode' as categorical
... storing 'gene' as categorical
... storing 'cell_line' as categorical
... storing 'gem_group' as categorical
... storing 'ctrl_cell_barcode' as categorical
INFO:state._cli._tx._predict:Saved adata_pred to /work/home/cryoem666/czx/project/state_training_debug/experiment/ba_loss_01_13/model_output/rpe1/0.7_0.3/eval_best.ckpt/adata_pred.h5ad
INFO:state._cli._tx._predict:Saved adata_real to /work/home/cryoem666/czx/project/state_training_debug/experiment/ba_loss_01_13/model_output/rpe1/0.7_0.3/eval_best.ckpt/adata_real.h5ad
INFO:state._cli._tx._predict:Computing metrics using cell-eval...
WARNING:cell_eval._evaluator:Output directory /work/home/cryoem666/czx/project/state_training_debug/experiment/ba_loss_01_13/model_output/rpe1/0.7_0.3/eval_best.ckpt already exists, potential overwrite occurring
INFO:cell_eval.utils:Data appears to be log1p normalized (decimals detected, range [0.00, 7.06])
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval.utils:Data appears to be log1p normalized (decimals detected, range [0.00, 6.05])
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Computing DE for real data
INFO:cell_eval._evaluator:Using the following pdex kwargs: {'exp_post_agg': True, 'is_log1p': True, 'reference': 'non-targeting', 'groupby_key': 'gene', 'num_workers': 56, 'batch_size': 2048, 'metric': 'wilcoxon', 'as_polars': True}
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/422 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 422/422 [00:00<00:00, 5136.90it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/6642 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 6642/6642 [00:00<00:00, 1058295.36it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=2802924
INFO:pdex._single_cell:Creating generator of all batches: N=1369
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/1369 [00:00<?, ?it/s]Processing batches:   0%|          | 1/1369 [00:00<02:23,  9.50it/s]Processing batches:   0%|          | 4/1369 [00:31<3:11:25,  8.41s/it]Processing batches:   0%|          | 5/1369 [00:39<3:13:20,  8.50s/it]Processing batches:   0%|          | 6/1369 [00:40<2:23:08,  6.30s/it]Processing batches:   4%|▍         | 57/1369 [00:53<11:45,  1.86it/s] Processing batches:   6%|▋         | 86/1369 [00:54<06:37,  3.23it/s]Processing batches:   7%|▋         | 89/1369 [00:55<06:45,  3.16it/s]Processing batches:   7%|▋         | 91/1369 [00:58<07:51,  2.71it/s]Processing batches:   7%|▋         | 95/1369 [00:58<07:19,  2.90it/s]Processing batches:   7%|▋         | 97/1369 [01:10<17:10,  1.23it/s]Processing batches:   8%|▊         | 107/1369 [01:10<10:55,  1.93it/s]Processing batches:   8%|▊         | 109/1369 [01:12<11:54,  1.76it/s]Processing batches:   8%|▊         | 110/1369 [01:16<16:44,  1.25it/s]Processing batches:   8%|▊         | 111/1369 [01:18<17:51,  1.17it/s]Processing batches:   8%|▊         | 112/1369 [01:18<17:13,  1.22it/s]Processing batches:   9%|▉         | 123/1369 [01:26<14:56,  1.39it/s]Processing batches:  10%|▉         | 131/1369 [01:30<12:58,  1.59it/s]Processing batches:  10%|█         | 142/1369 [01:35<11:39,  1.75it/s]Processing batches:  12%|█▏        | 159/1369 [01:35<06:00,  3.36it/s]Processing batches:  12%|█▏        | 167/1369 [01:37<05:44,  3.49it/s]Processing batches:  12%|█▏        | 169/1369 [01:38<05:57,  3.35it/s]Processing batches:  13%|█▎        | 172/1369 [01:43<10:03,  1.98it/s]Processing batches:  14%|█▍        | 190/1369 [01:47<06:33,  3.00it/s]Processing batches:  14%|█▍        | 193/1369 [01:48<06:38,  2.95it/s]Processing batches:  15%|█▍        | 204/1369 [01:48<04:17,  4.52it/s]Processing batches:  15%|█▌        | 206/1369 [01:55<09:24,  2.06it/s]Processing batches:  16%|█▌        | 216/1369 [01:59<08:56,  2.15it/s]Processing batches:  17%|█▋        | 229/1369 [02:02<07:03,  2.69it/s]Processing batches:  17%|█▋        | 231/1369 [02:03<07:18,  2.60it/s]Processing batches:  18%|█▊        | 240/1369 [02:04<05:27,  3.44it/s]Processing batches:  18%|█▊        | 242/1369 [02:04<05:10,  3.63it/s]Processing batches:  18%|█▊        | 245/1369 [02:05<04:35,  4.08it/s]Processing batches:  18%|█▊        | 246/1369 [02:05<04:29,  4.16it/s]Processing batches:  18%|█▊        | 247/1369 [02:06<05:26,  3.44it/s]Processing batches:  18%|█▊        | 249/1369 [02:07<07:47,  2.40it/s]Processing batches:  18%|█▊        | 250/1369 [02:09<10:01,  1.86it/s]Processing batches:  18%|█▊        | 253/1369 [02:09<07:28,  2.49it/s]Processing batches:  19%|█▊        | 256/1369 [02:10<05:55,  3.13it/s]Processing batches:  19%|█▉        | 257/1369 [02:12<11:12,  1.65it/s]Processing batches:  19%|█▉        | 258/1369 [02:12<10:03,  1.84it/s]Processing batches:  19%|█▉        | 259/1369 [02:13<12:19,  1.50it/s]Processing batches:  19%|█▉        | 264/1369 [02:14<06:42,  2.75it/s]Processing batches:  19%|█▉        | 266/1369 [02:15<07:49,  2.35it/s]Processing batches:  20%|█▉        | 267/1369 [02:19<15:20,  1.20it/s]Processing batches:  20%|██        | 276/1369 [02:20<07:35,  2.40it/s]Processing batches:  20%|██        | 280/1369 [02:21<06:07,  2.96it/s]Processing batches:  21%|██        | 285/1369 [02:25<08:30,  2.12it/s]Processing batches:  21%|██        | 287/1369 [02:25<07:35,  2.38it/s]Processing batches:  21%|██▏       | 291/1369 [02:28<09:10,  1.96it/s]Processing batches:  22%|██▏       | 297/1369 [02:28<06:01,  2.97it/s]Processing batches:  22%|██▏       | 299/1369 [02:34<13:04,  1.36it/s]Processing batches:  22%|██▏       | 306/1369 [02:34<07:29,  2.37it/s]Processing batches:  23%|██▎       | 309/1369 [02:35<07:13,  2.44it/s]Processing batches:  23%|██▎       | 318/1369 [02:40<08:20,  2.10it/s]Processing batches:  23%|██▎       | 319/1369 [02:45<14:11,  1.23it/s]Processing batches:  25%|██▍       | 339/1369 [02:46<05:00,  3.42it/s]Processing batches:  25%|██▌       | 345/1369 [02:46<04:08,  4.12it/s]Processing batches:  25%|██▌       | 347/1369 [02:52<08:29,  2.01it/s]Processing batches:  26%|██▌       | 358/1369 [02:55<06:19,  2.66it/s]Processing batches:  26%|██▋       | 362/1369 [02:55<05:23,  3.11it/s]Processing batches:  27%|██▋       | 371/1369 [02:58<05:16,  3.16it/s]Processing batches:  27%|██▋       | 373/1369 [02:58<04:53,  3.39it/s]Processing batches:  28%|██▊       | 377/1369 [03:00<05:29,  3.01it/s]Processing batches:  28%|██▊       | 384/1369 [03:00<03:56,  4.17it/s]Processing batches:  28%|██▊       | 387/1369 [03:04<06:55,  2.36it/s]Processing batches:  29%|██▊       | 391/1369 [03:04<05:24,  3.01it/s]Processing batches:  29%|██▊       | 392/1369 [03:06<07:32,  2.16it/s]Processing batches:  29%|██▉       | 397/1369 [03:07<05:55,  2.73it/s]Processing batches:  29%|██▉       | 398/1369 [03:08<06:02,  2.68it/s]Processing batches:  29%|██▉       | 399/1369 [03:10<09:55,  1.63it/s]Processing batches:  29%|██▉       | 401/1369 [03:11<10:22,  1.56it/s]Processing batches:  30%|██▉       | 409/1369 [03:12<05:21,  2.99it/s]Processing batches:  30%|███       | 413/1369 [03:13<04:37,  3.45it/s]Processing batches:  30%|███       | 414/1369 [03:15<06:21,  2.51it/s]Processing batches:  30%|███       | 416/1369 [03:16<07:35,  2.09it/s]Processing batches:  31%|███       | 418/1369 [03:18<09:59,  1.59it/s]Processing batches:  31%|███       | 425/1369 [03:21<08:02,  1.96it/s]Processing batches:  32%|███▏      | 432/1369 [03:22<05:23,  2.90it/s]Processing batches:  32%|███▏      | 433/1369 [03:22<05:16,  2.95it/s]Processing batches:  32%|███▏      | 439/1369 [03:25<05:24,  2.86it/s]Processing batches:  33%|███▎      | 445/1369 [03:27<05:29,  2.80it/s]Processing batches:  33%|███▎      | 447/1369 [03:29<06:58,  2.20it/s]Processing batches:  33%|███▎      | 452/1369 [03:30<05:24,  2.82it/s]Processing batches:  33%|███▎      | 453/1369 [03:32<07:46,  1.96it/s]Processing batches:  34%|███▎      | 461/1369 [03:35<06:54,  2.19it/s]Processing batches:  34%|███▍      | 466/1369 [03:37<06:27,  2.33it/s]Processing batches:  35%|███▍      | 474/1369 [03:38<04:56,  3.02it/s]Processing batches:  35%|███▍      | 475/1369 [03:39<05:13,  2.85it/s]Processing batches:  35%|███▍      | 479/1369 [03:39<04:08,  3.58it/s]Processing batches:  35%|███▌      | 483/1369 [03:44<07:23,  2.00it/s]Processing batches:  36%|███▌      | 487/1369 [03:46<07:18,  2.01it/s]Processing batches:  36%|███▌      | 490/1369 [03:47<07:38,  1.92it/s]Processing batches:  37%|███▋      | 501/1369 [03:49<04:40,  3.09it/s]Processing batches:  37%|███▋      | 506/1369 [03:49<03:32,  4.05it/s]Processing batches:  37%|███▋      | 508/1369 [03:53<06:52,  2.09it/s]Processing batches:  37%|███▋      | 512/1369 [03:53<05:06,  2.79it/s]Processing batches:  38%|███▊      | 517/1369 [03:57<07:02,  2.02it/s]Processing batches:  38%|███▊      | 524/1369 [03:59<05:07,  2.75it/s]Processing batches:  38%|███▊      | 525/1369 [04:00<06:29,  2.17it/s]Processing batches:  39%|███▊      | 530/1369 [04:02<05:32,  2.52it/s]Processing batches:  39%|███▉      | 534/1369 [04:02<04:31,  3.07it/s]Processing batches:  39%|███▉      | 538/1369 [04:03<04:03,  3.41it/s]Processing batches:  40%|███▉      | 541/1369 [04:04<04:27,  3.10it/s]Processing batches:  40%|███▉      | 547/1369 [04:09<07:01,  1.95it/s]Processing batches:  40%|████      | 551/1369 [04:11<06:39,  2.05it/s]Processing batches:  41%|████      | 555/1369 [04:11<04:58,  2.73it/s]Processing batches:  41%|████      | 556/1369 [04:11<04:39,  2.91it/s]Processing batches:  41%|████      | 559/1369 [04:13<05:20,  2.53it/s]Processing batches:  41%|████      | 560/1369 [04:14<07:21,  1.83it/s]Processing batches:  42%|████▏     | 570/1369 [04:16<04:13,  3.15it/s]Processing batches:  42%|████▏     | 572/1369 [04:18<05:16,  2.52it/s]Processing batches:  42%|████▏     | 580/1369 [04:19<03:39,  3.59it/s]Processing batches:  42%|████▏     | 581/1369 [04:22<06:37,  1.98it/s]Processing batches:  43%|████▎     | 587/1369 [04:23<05:01,  2.60it/s]Processing batches:  43%|████▎     | 588/1369 [04:25<05:58,  2.18it/s]Processing batches:  43%|████▎     | 594/1369 [04:27<05:17,  2.44it/s]Processing batches:  44%|████▍     | 603/1369 [04:28<03:36,  3.54it/s]Processing batches:  44%|████▍     | 606/1369 [04:29<03:24,  3.72it/s]Processing batches:  44%|████▍     | 607/1369 [04:31<05:11,  2.45it/s]Processing batches:  45%|████▍     | 611/1369 [04:34<06:26,  1.96it/s]Processing batches:  45%|████▍     | 613/1369 [04:34<06:07,  2.06it/s]Processing batches:  45%|████▍     | 614/1369 [04:35<06:05,  2.07it/s]Processing batches:  45%|████▍     | 615/1369 [04:35<06:24,  1.96it/s]Processing batches:  45%|████▌     | 619/1369 [04:38<06:48,  1.84it/s]Processing batches:  46%|████▌     | 625/1369 [04:38<03:54,  3.17it/s]Processing batches:  46%|████▌     | 630/1369 [04:39<03:16,  3.75it/s]Processing batches:  46%|████▋     | 635/1369 [04:42<04:13,  2.89it/s]Processing batches:  47%|████▋     | 640/1369 [04:42<03:03,  3.97it/s]Processing batches:  47%|████▋     | 641/1369 [04:43<04:02,  3.00it/s]Processing batches:  47%|████▋     | 642/1369 [04:46<08:01,  1.51it/s]Processing batches:  48%|████▊     | 651/1369 [04:48<04:43,  2.53it/s]Processing batches:  48%|████▊     | 656/1369 [04:50<04:15,  2.79it/s]Processing batches:  48%|████▊     | 658/1369 [04:50<03:46,  3.14it/s]Processing batches:  48%|████▊     | 661/1369 [04:50<03:00,  3.92it/s]Processing batches:  48%|████▊     | 663/1369 [04:51<03:56,  2.99it/s]Processing batches:  49%|████▊     | 664/1369 [04:52<03:37,  3.24it/s]Processing batches:  49%|████▊     | 665/1369 [04:53<06:01,  1.95it/s]Processing batches:  49%|████▉     | 669/1369 [04:53<03:24,  3.42it/s]Processing batches:  49%|████▉     | 671/1369 [04:57<08:20,  1.39it/s]Processing batches:  49%|████▉     | 674/1369 [04:58<06:04,  1.90it/s]Processing batches:  49%|████▉     | 677/1369 [04:59<05:09,  2.23it/s]Processing batches:  50%|█████     | 685/1369 [05:04<06:19,  1.80it/s]Processing batches:  51%|█████     | 695/1369 [05:07<04:46,  2.35it/s]Processing batches:  51%|█████▏    | 703/1369 [05:07<03:06,  3.56it/s]Processing batches:  52%|█████▏    | 706/1369 [05:10<04:14,  2.61it/s]Processing batches:  52%|█████▏    | 709/1369 [05:11<04:17,  2.57it/s]Processing batches:  52%|█████▏    | 712/1369 [05:12<04:29,  2.44it/s]Processing batches:  52%|█████▏    | 716/1369 [05:13<03:37,  3.00it/s]Processing batches:  52%|█████▏    | 717/1369 [05:15<05:28,  1.99it/s]Processing batches:  53%|█████▎    | 724/1369 [05:16<03:16,  3.29it/s]Processing batches:  53%|█████▎    | 726/1369 [05:17<03:40,  2.91it/s]Processing batches:  53%|█████▎    | 727/1369 [05:17<03:35,  2.98it/s]Processing batches:  53%|█████▎    | 728/1369 [05:18<03:59,  2.68it/s]Processing batches:  53%|█████▎    | 731/1369 [05:22<07:32,  1.41it/s]Processing batches:  53%|█████▎    | 732/1369 [05:24<09:43,  1.09it/s]Processing batches:  54%|█████▍    | 744/1369 [05:24<02:56,  3.55it/s]Processing batches:  55%|█████▍    | 749/1369 [05:29<04:43,  2.19it/s]Processing batches:  55%|█████▍    | 751/1369 [05:30<04:53,  2.10it/s]Processing batches:  56%|█████▌    | 760/1369 [05:32<03:36,  2.81it/s]Processing batches:  56%|█████▌    | 765/1369 [05:33<03:04,  3.28it/s]Processing batches:  56%|█████▌    | 766/1369 [05:33<03:21,  3.00it/s]Processing batches:  56%|█████▌    | 768/1369 [05:36<05:07,  1.95it/s]Processing batches:  56%|█████▋    | 773/1369 [05:37<03:53,  2.56it/s]Processing batches:  57%|█████▋    | 775/1369 [05:37<03:24,  2.90it/s]Processing batches:  57%|█████▋    | 780/1369 [05:41<04:56,  1.99it/s]Processing batches:  58%|█████▊    | 789/1369 [05:41<02:32,  3.80it/s]Processing batches:  58%|█████▊    | 791/1369 [05:42<02:43,  3.53it/s]Processing batches:  58%|█████▊    | 793/1369 [05:42<02:21,  4.08it/s]Processing batches:  58%|█████▊    | 795/1369 [05:47<06:19,  1.51it/s]Processing batches:  58%|█████▊    | 798/1369 [05:49<06:07,  1.55it/s]Processing batches:  58%|█████▊    | 800/1369 [05:51<06:50,  1.38it/s]Processing batches:  60%|█████▉    | 815/1369 [05:52<02:20,  3.94it/s]Processing batches:  60%|█████▉    | 816/1369 [05:54<03:46,  2.44it/s]Processing batches:  60%|█████▉    | 818/1369 [05:57<05:10,  1.77it/s]Processing batches:  60%|██████    | 826/1369 [05:57<02:48,  3.23it/s]Processing batches:  61%|██████    | 829/1369 [05:58<02:26,  3.69it/s]Processing batches:  61%|██████    | 831/1369 [06:03<05:26,  1.65it/s]Processing batches:  62%|██████▏   | 846/1369 [06:08<03:53,  2.24it/s]Processing batches:  62%|██████▏   | 854/1369 [06:08<02:49,  3.03it/s]Processing batches:  63%|██████▎   | 856/1369 [06:10<03:18,  2.59it/s]Processing batches:  63%|██████▎   | 857/1369 [06:13<04:36,  1.85it/s]Processing batches:  63%|██████▎   | 868/1369 [06:14<02:26,  3.42it/s]Processing batches:  64%|██████▎   | 870/1369 [06:18<04:09,  2.00it/s]Processing batches:  64%|██████▍   | 875/1369 [06:18<03:14,  2.54it/s]Processing batches:  64%|██████▍   | 876/1369 [06:22<05:33,  1.48it/s]Processing batches:  64%|██████▍   | 883/1369 [06:26<04:55,  1.64it/s]Processing batches:  66%|██████▌   | 899/1369 [06:27<02:13,  3.53it/s]Processing batches:  66%|██████▌   | 900/1369 [06:27<02:18,  3.40it/s]Processing batches:  66%|██████▌   | 901/1369 [06:29<02:57,  2.63it/s]Processing batches:  66%|██████▋   | 908/1369 [06:30<02:10,  3.52it/s]Processing batches:  66%|██████▋   | 909/1369 [06:34<04:14,  1.81it/s]Processing batches:  67%|██████▋   | 922/1369 [06:37<02:55,  2.54it/s]Processing batches:  67%|██████▋   | 924/1369 [06:38<02:39,  2.79it/s]Processing batches:  68%|██████▊   | 930/1369 [06:40<02:51,  2.56it/s]Processing batches:  68%|██████▊   | 932/1369 [06:44<04:15,  1.71it/s]Processing batches:  69%|██████▊   | 940/1369 [06:44<02:25,  2.94it/s]Processing batches:  69%|██████▉   | 942/1369 [06:45<02:24,  2.95it/s]Processing batches:  69%|██████▉   | 948/1369 [06:48<02:43,  2.58it/s]Processing batches:  70%|██████▉   | 953/1369 [06:50<02:54,  2.38it/s]Processing batches:  70%|██████▉   | 955/1369 [06:50<02:36,  2.64it/s]Processing batches:  70%|██████▉   | 956/1369 [06:51<02:38,  2.61it/s]Processing batches:  70%|███████   | 959/1369 [06:51<02:15,  3.03it/s]Processing batches:  70%|███████   | 964/1369 [06:54<02:51,  2.36it/s]Processing batches:  71%|███████   | 973/1369 [06:55<01:45,  3.76it/s]Processing batches:  71%|███████   | 974/1369 [06:56<02:01,  3.25it/s]Processing batches:  71%|███████▏  | 976/1369 [06:57<01:57,  3.33it/s]Processing batches:  71%|███████▏  | 977/1369 [06:59<03:15,  2.01it/s]Processing batches:  72%|███████▏  | 982/1369 [07:02<03:22,  1.91it/s]Processing batches:  72%|███████▏  | 989/1369 [07:03<02:32,  2.49it/s]Processing batches:  73%|███████▎  | 996/1369 [07:04<01:45,  3.53it/s]Processing batches:  73%|███████▎  | 997/1369 [07:05<02:03,  3.02it/s]Processing batches:  73%|███████▎  | 999/1369 [07:10<04:12,  1.47it/s]Processing batches:  74%|███████▎  | 1008/1369 [07:10<01:57,  3.08it/s]Processing batches:  74%|███████▍  | 1011/1369 [07:12<02:32,  2.35it/s]Processing batches:  74%|███████▍  | 1015/1369 [07:13<02:03,  2.87it/s]Processing batches:  74%|███████▍  | 1017/1369 [07:15<02:47,  2.11it/s]Processing batches:  75%|███████▍  | 1020/1369 [07:15<02:08,  2.72it/s]Processing batches:  75%|███████▌  | 1028/1369 [07:18<02:09,  2.64it/s]Processing batches:  75%|███████▌  | 1031/1369 [07:19<01:55,  2.93it/s]Processing batches:  75%|███████▌  | 1033/1369 [07:19<01:47,  3.11it/s]Processing batches:  76%|███████▌  | 1034/1369 [07:20<01:55,  2.90it/s]Processing batches:  76%|███████▌  | 1035/1369 [07:20<01:51,  2.99it/s]Processing batches:  76%|███████▌  | 1038/1369 [07:22<02:40,  2.06it/s]Processing batches:  76%|███████▌  | 1042/1369 [07:24<02:30,  2.17it/s]Processing batches:  76%|███████▌  | 1043/1369 [07:25<02:36,  2.08it/s]Processing batches:  76%|███████▋  | 1045/1369 [07:26<02:27,  2.20it/s]Processing batches:  77%|███████▋  | 1050/1369 [07:26<01:36,  3.30it/s]Processing batches:  77%|███████▋  | 1053/1369 [07:27<01:16,  4.12it/s]Processing batches:  77%|███████▋  | 1055/1369 [07:28<01:51,  2.83it/s]Processing batches:  77%|███████▋  | 1059/1369 [07:30<02:08,  2.41it/s]Processing batches:  78%|███████▊  | 1064/1369 [07:32<01:57,  2.60it/s]Processing batches:  78%|███████▊  | 1065/1369 [07:35<03:27,  1.47it/s]Processing batches:  78%|███████▊  | 1071/1369 [07:38<02:54,  1.71it/s]Processing batches:  79%|███████▊  | 1076/1369 [07:39<02:13,  2.19it/s]Processing batches:  79%|███████▉  | 1082/1369 [07:42<02:08,  2.23it/s]Processing batches:  79%|███████▉  | 1086/1369 [07:44<02:14,  2.10it/s]Processing batches:  80%|████████  | 1096/1369 [07:45<01:26,  3.15it/s]Processing batches:  80%|████████  | 1097/1369 [07:49<02:19,  1.95it/s]Processing batches:  81%|████████  | 1103/1369 [07:49<01:37,  2.74it/s]Processing batches:  81%|████████  | 1104/1369 [07:49<01:33,  2.84it/s]Processing batches:  81%|████████  | 1107/1369 [07:50<01:26,  3.04it/s]Processing batches:  81%|████████  | 1112/1369 [07:51<00:58,  4.40it/s]Processing batches:  81%|████████▏ | 1115/1369 [07:52<01:05,  3.86it/s]Processing batches:  82%|████████▏ | 1118/1369 [07:54<01:42,  2.44it/s]Processing batches:  82%|████████▏ | 1122/1369 [07:54<01:12,  3.40it/s]Processing batches:  82%|████████▏ | 1124/1369 [07:55<01:05,  3.71it/s]Processing batches:  82%|████████▏ | 1126/1369 [07:55<00:58,  4.17it/s]Processing batches:  82%|████████▏ | 1127/1369 [07:56<01:24,  2.88it/s]Processing batches:  82%|████████▏ | 1129/1369 [08:03<04:34,  1.14s/it]Processing batches:  83%|████████▎ | 1135/1369 [08:04<02:38,  1.48it/s]Processing batches:  83%|████████▎ | 1136/1369 [08:05<02:27,  1.57it/s]Processing batches:  83%|████████▎ | 1137/1369 [08:05<02:15,  1.71it/s]Processing batches:  83%|████████▎ | 1140/1369 [08:06<02:04,  1.83it/s]Processing batches:  83%|████████▎ | 1143/1369 [08:09<02:24,  1.57it/s]Processing batches:  84%|████████▍ | 1152/1369 [08:10<01:08,  3.18it/s]Processing batches:  85%|████████▍ | 1159/1369 [08:11<00:52,  4.03it/s]Processing batches:  85%|████████▍ | 1163/1369 [08:16<01:47,  1.93it/s]Processing batches:  86%|████████▌ | 1176/1369 [08:19<01:06,  2.90it/s]Processing batches:  87%|████████▋ | 1186/1369 [08:20<00:49,  3.73it/s]Processing batches:  87%|████████▋ | 1187/1369 [08:21<00:55,  3.25it/s]Processing batches:  87%|████████▋ | 1190/1369 [08:25<01:26,  2.08it/s]Processing batches:  87%|████████▋ | 1193/1369 [08:30<02:09,  1.36it/s]Processing batches:  87%|████████▋ | 1197/1369 [08:30<01:36,  1.78it/s]Processing batches:  88%|████████▊ | 1198/1369 [08:31<01:34,  1.82it/s]Processing batches:  88%|████████▊ | 1205/1369 [08:32<01:01,  2.68it/s]Processing batches:  88%|████████▊ | 1210/1369 [08:33<00:49,  3.22it/s]Processing batches:  89%|████████▊ | 1213/1369 [08:37<01:19,  1.95it/s]Processing batches:  89%|████████▉ | 1225/1369 [08:37<00:36,  3.89it/s]Processing batches:  90%|████████▉ | 1226/1369 [08:39<00:46,  3.08it/s]Processing batches:  90%|████████▉ | 1228/1369 [08:39<00:42,  3.33it/s]Processing batches:  90%|████████▉ | 1230/1369 [08:39<00:36,  3.82it/s]Processing batches:  90%|████████▉ | 1232/1369 [08:42<01:09,  1.96it/s]Processing batches:  91%|█████████ | 1243/1369 [08:43<00:32,  3.89it/s]Processing batches:  91%|█████████ | 1246/1369 [08:44<00:31,  3.90it/s]Processing batches:  91%|█████████ | 1247/1369 [08:46<00:51,  2.39it/s]Processing batches:  91%|█████████ | 1248/1369 [08:47<00:57,  2.10it/s]Processing batches:  92%|█████████▏| 1253/1369 [08:49<00:51,  2.27it/s]Processing batches:  92%|█████████▏| 1254/1369 [08:50<00:53,  2.17it/s]Processing batches:  92%|█████████▏| 1255/1369 [08:50<00:52,  2.18it/s]Processing batches:  92%|█████████▏| 1258/1369 [08:50<00:33,  3.31it/s]Processing batches:  92%|█████████▏| 1260/1369 [08:52<00:50,  2.16it/s]Processing batches:  92%|█████████▏| 1261/1369 [08:55<01:36,  1.12it/s]Processing batches:  93%|█████████▎| 1269/1369 [08:57<00:45,  2.22it/s]Processing batches:  93%|█████████▎| 1278/1369 [09:00<00:36,  2.48it/s]Processing batches:  94%|█████████▎| 1282/1369 [09:03<00:42,  2.06it/s]Processing batches:  94%|█████████▍| 1290/1369 [09:03<00:23,  3.35it/s]Processing batches:  94%|█████████▍| 1293/1369 [09:04<00:19,  3.92it/s]Processing batches:  95%|█████████▍| 1296/1369 [09:05<00:20,  3.54it/s]Processing batches:  95%|█████████▍| 1298/1369 [09:08<00:35,  2.01it/s]Processing batches:  95%|█████████▌| 1307/1369 [09:09<00:18,  3.44it/s]Processing batches:  96%|█████████▌| 1308/1369 [09:09<00:17,  3.42it/s]Processing batches:  96%|█████████▌| 1309/1369 [09:10<00:23,  2.59it/s]Processing batches:  96%|█████████▌| 1311/1369 [09:12<00:24,  2.32it/s]Processing batches:  96%|█████████▌| 1313/1369 [09:12<00:21,  2.60it/s]Processing batches:  96%|█████████▌| 1315/1369 [09:13<00:18,  2.87it/s]Processing batches:  96%|█████████▌| 1316/1369 [09:13<00:22,  2.32it/s]Processing batches:  96%|█████████▌| 1317/1369 [09:15<00:30,  1.69it/s]Processing batches:  96%|█████████▋| 1320/1369 [09:15<00:21,  2.28it/s]Processing batches:  97%|█████████▋| 1325/1369 [09:17<00:18,  2.39it/s]Processing batches:  97%|█████████▋| 1328/1369 [09:19<00:17,  2.28it/s]Processing batches:  97%|█████████▋| 1330/1369 [09:20<00:17,  2.28it/s]Processing batches:  98%|█████████▊| 1341/1369 [09:20<00:04,  5.69it/s]Processing batches:  98%|█████████▊| 1343/1369 [09:21<00:05,  4.37it/s]Processing batches:  98%|█████████▊| 1344/1369 [09:22<00:06,  3.91it/s]Processing batches:  98%|█████████▊| 1347/1369 [09:22<00:05,  4.36it/s]Processing batches:  98%|█████████▊| 1348/1369 [09:23<00:05,  3.57it/s]Processing batches:  99%|█████████▊| 1349/1369 [09:24<00:06,  2.88it/s]Processing batches:  99%|█████████▉| 1352/1369 [09:24<00:04,  3.80it/s]Processing batches:  99%|█████████▉| 1358/1369 [09:24<00:01,  6.86it/s]Processing batches:  99%|█████████▉| 1360/1369 [09:25<00:01,  5.55it/s]Processing batches:  99%|█████████▉| 1361/1369 [09:25<00:01,  4.54it/s]Processing batches:  99%|█████████▉| 1362/1369 [09:26<00:02,  3.37it/s]Processing batches: 100%|█████████▉| 1367/1369 [09:27<00:00,  4.67it/s]Processing batches: 100%|█████████▉| 1368/1369 [09:27<00:00,  3.85it/s]Processing batches: 100%|██████████| 1369/1369 [09:27<00:00,  2.41it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:cell_eval._evaluator:Writing real DE results to: rpe1_real_de.csv
INFO:cell_eval._evaluator:Computing DE for pred data
INFO:cell_eval._evaluator:Using the following pdex kwargs: {'exp_post_agg': True, 'is_log1p': True, 'reference': 'non-targeting', 'groupby_key': 'gene', 'num_workers': 56, 'batch_size': 2048, 'metric': 'wilcoxon', 'as_polars': True}
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/422 [00:00<?, ?it/s]Identifying target masks:  96%|█████████▌| 406/422 [00:00<00:00, 4051.15it/s]Identifying target masks: 100%|██████████| 422/422 [00:00<00:00, 3988.91it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/6642 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 6642/6642 [00:00<00:00, 876855.22it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=2802924
INFO:pdex._single_cell:Creating generator of all batches: N=1369
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/1369 [00:00<?, ?it/s]Processing batches:   0%|          | 1/1369 [00:00<02:58,  7.68it/s]Processing batches:   0%|          | 2/1369 [00:00<03:32,  6.42it/s]Processing batches:   0%|          | 4/1369 [00:33<3:57:14, 10.43s/it]Processing batches:   0%|          | 5/1369 [00:41<3:41:32,  9.75s/it]Processing batches:   0%|          | 6/1369 [00:42<2:41:46,  7.12s/it]Processing batches:   4%|▍         | 57/1369 [00:55<11:46,  1.86it/s] Processing batches:   6%|▌         | 76/1369 [00:56<08:15,  2.61it/s]Processing batches:   6%|▌         | 79/1369 [00:58<08:21,  2.57it/s]Processing batches:   6%|▌         | 83/1369 [01:00<08:39,  2.47it/s]Processing batches:   7%|▋         | 89/1369 [01:00<07:22,  2.89it/s]Processing batches:   7%|▋         | 90/1369 [01:02<09:01,  2.36it/s]Processing batches:   7%|▋         | 91/1369 [01:05<11:21,  1.87it/s]Processing batches:   7%|▋         | 96/1369 [01:14<19:55,  1.06it/s]Processing batches:   8%|▊         | 108/1369 [01:15<11:03,  1.90it/s]Processing batches:   8%|▊         | 109/1369 [01:17<11:53,  1.77it/s]Processing batches:   8%|▊         | 110/1369 [01:19<13:57,  1.50it/s]Processing batches:   8%|▊         | 112/1369 [01:19<12:31,  1.67it/s]Processing batches:   9%|▊         | 119/1369 [01:31<23:19,  1.12s/it]Processing batches:   9%|▉         | 130/1369 [01:33<13:27,  1.53it/s]Processing batches:  10%|▉         | 132/1369 [01:35<13:50,  1.49it/s]Processing batches:  11%|█▏        | 155/1369 [01:36<05:09,  3.93it/s]Processing batches:  11%|█▏        | 156/1369 [01:37<05:48,  3.48it/s]Processing batches:  11%|█▏        | 157/1369 [01:37<05:52,  3.44it/s]Processing batches:  12%|█▏        | 158/1369 [01:39<07:26,  2.71it/s]Processing batches:  12%|█▏        | 160/1369 [01:41<10:12,  1.97it/s]Processing batches:  12%|█▏        | 161/1369 [01:43<12:51,  1.57it/s]Processing batches:  12%|█▏        | 163/1369 [01:45<15:26,  1.30it/s]Processing batches:  12%|█▏        | 166/1369 [01:46<11:04,  1.81it/s]Processing batches:  12%|█▏        | 167/1369 [01:50<21:22,  1.07s/it]Processing batches:  13%|█▎        | 175/1369 [01:51<09:13,  2.16it/s]Processing batches:  13%|█▎        | 181/1369 [01:54<09:53,  2.00it/s]Processing batches:  15%|█▍        | 199/1369 [01:56<05:02,  3.87it/s]Processing batches:  15%|█▍        | 200/1369 [01:57<05:48,  3.35it/s]Processing batches:  15%|█▍        | 201/1369 [01:58<06:53,  2.82it/s]Processing batches:  15%|█▍        | 203/1369 [02:07<19:16,  1.01it/s]Processing batches:  15%|█▌        | 206/1369 [02:11<20:26,  1.05s/it]Processing batches:  15%|█▌        | 211/1369 [02:15<18:06,  1.07it/s]Processing batches:  17%|█▋        | 231/1369 [02:15<05:50,  3.25it/s]Processing batches:  17%|█▋        | 235/1369 [02:17<06:15,  3.02it/s]Processing batches:  17%|█▋        | 238/1369 [02:19<07:10,  2.63it/s]Processing batches:  18%|█▊        | 243/1369 [02:24<09:57,  1.88it/s]Processing batches:  18%|█▊        | 250/1369 [02:26<09:12,  2.02it/s]Processing batches:  19%|█▊        | 254/1369 [02:28<08:22,  2.22it/s]Processing batches:  20%|█▉        | 268/1369 [02:31<06:28,  2.84it/s]Processing batches:  20%|██        | 274/1369 [02:34<06:48,  2.68it/s]Processing batches:  20%|██        | 277/1369 [02:35<06:18,  2.88it/s]Processing batches:  20%|██        | 279/1369 [02:36<06:58,  2.61it/s]Processing batches:  21%|██        | 281/1369 [02:43<15:29,  1.17it/s]Processing batches:  21%|██        | 287/1369 [02:46<13:01,  1.38it/s]Processing batches:  21%|██▏       | 292/1369 [02:52<15:10,  1.18it/s]Processing batches:  22%|██▏       | 307/1369 [02:53<07:17,  2.43it/s]Processing batches:  23%|██▎       | 311/1369 [02:57<09:04,  1.94it/s]Processing batches:  23%|██▎       | 320/1369 [02:59<07:07,  2.45it/s]Processing batches:  24%|██▎       | 324/1369 [03:00<06:24,  2.72it/s]Processing batches:  25%|██▍       | 337/1369 [03:03<05:24,  3.18it/s]Processing batches:  25%|██▍       | 342/1369 [03:05<05:28,  3.13it/s]Processing batches:  25%|██▌       | 345/1369 [03:09<08:22,  2.04it/s]Processing batches:  26%|██▌       | 351/1369 [03:15<10:45,  1.58it/s]Processing batches:  26%|██▌       | 358/1369 [03:19<10:05,  1.67it/s]Processing batches:  27%|██▋       | 372/1369 [03:21<06:29,  2.56it/s]Processing batches:  27%|██▋       | 373/1369 [03:24<08:34,  1.94it/s]Processing batches:  28%|██▊       | 384/1369 [03:26<05:52,  2.80it/s]Processing batches:  28%|██▊       | 386/1369 [03:27<06:28,  2.53it/s]Processing batches:  29%|██▊       | 391/1369 [03:28<05:44,  2.84it/s]Processing batches:  29%|██▊       | 392/1369 [03:30<07:16,  2.24it/s]Processing batches:  29%|██▉       | 398/1369 [03:30<04:46,  3.39it/s]Processing batches:  29%|██▉       | 400/1369 [03:32<06:14,  2.59it/s]Processing batches:  30%|██▉       | 406/1369 [03:33<04:34,  3.51it/s]Processing batches:  30%|██▉       | 408/1369 [03:34<05:27,  2.94it/s]Processing batches:  30%|██▉       | 409/1369 [03:34<05:22,  2.98it/s]Processing batches:  30%|██▉       | 410/1369 [03:37<10:20,  1.55it/s]Processing batches:  31%|███       | 418/1369 [03:38<05:27,  2.91it/s]Processing batches:  31%|███       | 419/1369 [03:40<07:36,  2.08it/s]Processing batches:  31%|███       | 420/1369 [03:45<16:57,  1.07s/it]Processing batches:  31%|███▏      | 431/1369 [03:49<09:27,  1.65it/s]Processing batches:  32%|███▏      | 437/1369 [03:50<06:26,  2.41it/s]Processing batches:  32%|███▏      | 439/1369 [03:50<06:04,  2.55it/s]Processing batches:  32%|███▏      | 443/1369 [03:55<09:51,  1.57it/s]Processing batches:  33%|███▎      | 449/1369 [03:56<06:47,  2.26it/s]Processing batches:  33%|███▎      | 450/1369 [03:57<07:28,  2.05it/s]Processing batches:  33%|███▎      | 456/1369 [04:00<07:20,  2.07it/s]Processing batches:  34%|███▍      | 469/1369 [04:00<03:34,  4.20it/s]Processing batches:  34%|███▍      | 471/1369 [04:01<03:49,  3.92it/s]Processing batches:  35%|███▍      | 473/1369 [04:05<07:32,  1.98it/s]Processing batches:  35%|███▍      | 477/1369 [04:06<05:48,  2.56it/s]Processing batches:  35%|███▌      | 480/1369 [04:08<07:28,  1.98it/s]Processing batches:  35%|███▌      | 482/1369 [04:11<10:13,  1.45it/s]Processing batches:  36%|███▌      | 489/1369 [04:14<07:44,  1.89it/s]Processing batches:  36%|███▌      | 490/1369 [04:17<11:45,  1.25it/s]Processing batches:  36%|███▌      | 496/1369 [04:21<10:44,  1.35it/s]Processing batches:  37%|███▋      | 508/1369 [04:25<06:54,  2.08it/s]Processing batches:  37%|███▋      | 510/1369 [04:31<10:59,  1.30it/s]Processing batches:  38%|███▊      | 525/1369 [04:31<04:52,  2.89it/s]Processing batches:  39%|███▉      | 534/1369 [04:34<04:48,  2.89it/s]Processing batches:  39%|███▉      | 539/1369 [04:34<04:11,  3.31it/s]Processing batches:  40%|███▉      | 542/1369 [04:36<04:24,  3.13it/s]Processing batches:  40%|███▉      | 544/1369 [04:40<07:09,  1.92it/s]Processing batches:  40%|████      | 549/1369 [04:42<07:21,  1.86it/s]Processing batches:  40%|████      | 554/1369 [04:43<05:16,  2.58it/s]Processing batches:  41%|████      | 556/1369 [04:48<10:03,  1.35it/s]Processing batches:  41%|████▏     | 567/1369 [04:52<07:13,  1.85it/s]Processing batches:  42%|████▏     | 575/1369 [04:53<04:56,  2.68it/s]Processing batches:  43%|████▎     | 585/1369 [04:57<05:09,  2.53it/s]Processing batches:  43%|████▎     | 588/1369 [05:01<07:05,  1.83it/s]Processing batches:  44%|████▍     | 599/1369 [05:02<04:03,  3.16it/s]Processing batches:  44%|████▍     | 602/1369 [05:02<03:46,  3.38it/s]Processing batches:  44%|████▍     | 605/1369 [05:04<04:38,  2.75it/s]Processing batches:  44%|████▍     | 607/1369 [05:07<06:32,  1.94it/s]Processing batches:  45%|████▍     | 611/1369 [05:08<05:50,  2.16it/s]Processing batches:  45%|████▍     | 612/1369 [05:11<08:15,  1.53it/s]Processing batches:  45%|████▌     | 618/1369 [05:12<05:26,  2.30it/s]Processing batches:  46%|████▌     | 623/1369 [05:13<04:35,  2.70it/s]Processing batches:  46%|████▌     | 624/1369 [05:19<10:53,  1.14it/s]Processing batches:  46%|████▋     | 636/1369 [05:20<04:33,  2.68it/s]Processing batches:  47%|████▋     | 638/1369 [05:23<06:32,  1.86it/s]Processing batches:  47%|████▋     | 643/1369 [05:26<06:55,  1.75it/s]Processing batches:  47%|████▋     | 648/1369 [05:28<06:01,  1.99it/s]Processing batches:  48%|████▊     | 651/1369 [05:28<05:08,  2.32it/s]Processing batches:  48%|████▊     | 655/1369 [05:35<09:02,  1.32it/s]Processing batches:  49%|████▊     | 667/1369 [05:35<04:14,  2.76it/s]Processing batches:  49%|████▉     | 669/1369 [05:36<03:55,  2.97it/s]Processing batches:  49%|████▉     | 675/1369 [05:42<06:34,  1.76it/s]Processing batches:  50%|█████     | 687/1369 [05:43<03:42,  3.06it/s]Processing batches:  50%|█████     | 688/1369 [05:46<05:38,  2.01it/s]Processing batches:  50%|█████     | 690/1369 [05:47<05:52,  1.92it/s]Processing batches:  51%|█████     | 692/1369 [05:52<09:28,  1.19it/s]Processing batches:  51%|█████▏    | 703/1369 [05:57<06:44,  1.64it/s]Processing batches:  52%|█████▏    | 707/1369 [05:58<06:02,  1.83it/s]Processing batches:  52%|█████▏    | 713/1369 [06:00<05:07,  2.13it/s]Processing batches:  53%|█████▎    | 728/1369 [06:09<05:39,  1.89it/s]Processing batches:  54%|█████▍    | 742/1369 [06:12<04:17,  2.43it/s]Processing batches:  55%|█████▍    | 748/1369 [06:14<03:50,  2.70it/s]Processing batches:  55%|█████▍    | 751/1369 [06:16<04:27,  2.31it/s]Processing batches:  55%|█████▌    | 754/1369 [06:17<04:00,  2.55it/s]Processing batches:  56%|█████▌    | 763/1369 [06:27<06:46,  1.49it/s]Processing batches:  57%|█████▋    | 777/1369 [06:30<04:40,  2.11it/s]Processing batches:  57%|█████▋    | 782/1369 [06:32<04:16,  2.29it/s]Processing batches:  57%|█████▋    | 785/1369 [06:32<04:02,  2.41it/s]Processing batches:  58%|█████▊    | 793/1369 [06:33<02:42,  3.55it/s]Processing batches:  58%|█████▊    | 795/1369 [06:34<03:14,  2.94it/s]Processing batches:  58%|█████▊    | 797/1369 [06:35<03:15,  2.92it/s]Processing batches:  59%|█████▊    | 801/1369 [06:44<08:09,  1.16it/s]Processing batches:  60%|█████▉    | 817/1369 [06:45<03:31,  2.62it/s]Processing batches:  60%|█████▉    | 820/1369 [06:46<03:14,  2.82it/s]Processing batches:  60%|██████    | 827/1369 [06:46<02:29,  3.62it/s]Processing batches:  61%|██████    | 829/1369 [06:48<02:46,  3.25it/s]Processing batches:  61%|██████    | 831/1369 [06:53<06:00,  1.49it/s]Processing batches:  61%|██████▏   | 839/1369 [07:00<06:43,  1.31it/s]Processing batches:  62%|██████▏   | 847/1369 [07:04<05:48,  1.50it/s]Processing batches:  62%|██████▏   | 850/1369 [07:05<04:58,  1.74it/s]Processing batches:  63%|██████▎   | 862/1369 [07:06<02:42,  3.11it/s]Processing batches:  63%|██████▎   | 868/1369 [07:08<02:48,  2.97it/s]Processing batches:  64%|██████▎   | 870/1369 [07:11<04:05,  2.03it/s]Processing batches:  64%|██████▍   | 874/1369 [07:12<03:30,  2.36it/s]Processing batches:  64%|██████▍   | 878/1369 [07:20<06:31,  1.25it/s]Processing batches:  65%|██████▌   | 895/1369 [07:22<02:58,  2.65it/s]Processing batches:  65%|██████▌   | 896/1369 [07:24<03:51,  2.04it/s]Processing batches:  66%|██████▋   | 907/1369 [07:25<02:22,  3.24it/s]Processing batches:  66%|██████▋   | 908/1369 [07:27<03:00,  2.56it/s]Processing batches:  66%|██████▋   | 909/1369 [07:32<05:45,  1.33it/s]Processing batches:  67%|██████▋   | 919/1369 [07:34<03:16,  2.28it/s]Processing batches:  67%|██████▋   | 920/1369 [07:36<04:00,  1.86it/s]Processing batches:  67%|██████▋   | 921/1369 [07:36<03:44,  2.00it/s]Processing batches:  68%|██████▊   | 933/1369 [07:37<01:55,  3.79it/s]Processing batches:  68%|██████▊   | 935/1369 [07:40<02:51,  2.53it/s]Processing batches:  68%|██████▊   | 936/1369 [07:40<02:41,  2.67it/s]Processing batches:  69%|██████▉   | 946/1369 [07:44<02:47,  2.53it/s]Processing batches:  69%|██████▉   | 948/1369 [07:45<02:45,  2.55it/s]Processing batches:  69%|██████▉   | 951/1369 [07:53<06:11,  1.12it/s]Processing batches:  70%|███████   | 962/1369 [07:54<03:12,  2.12it/s]Processing batches:  71%|███████   | 968/1369 [07:57<03:13,  2.07it/s]Processing batches:  71%|███████   | 975/1369 [08:01<03:32,  1.86it/s]Processing batches:  72%|███████▏  | 979/1369 [08:06<04:17,  1.51it/s]Processing batches:  72%|███████▏  | 987/1369 [08:09<03:40,  1.73it/s]Processing batches:  73%|███████▎  | 1006/1369 [08:13<02:12,  2.74it/s]Processing batches:  74%|███████▎  | 1007/1369 [08:14<02:17,  2.63it/s]Processing batches:  74%|███████▍  | 1017/1369 [08:19<02:33,  2.30it/s]Processing batches:  75%|███████▍  | 1021/1369 [08:27<03:57,  1.46it/s]Processing batches:  76%|███████▌  | 1038/1369 [08:27<01:58,  2.79it/s]Processing batches:  76%|███████▌  | 1040/1369 [08:30<02:25,  2.26it/s]Processing batches:  76%|███████▌  | 1043/1369 [08:32<02:30,  2.17it/s]Processing batches:  77%|███████▋  | 1048/1369 [08:32<01:53,  2.83it/s]Processing batches:  77%|███████▋  | 1051/1369 [08:36<02:46,  1.91it/s]Processing batches:  77%|███████▋  | 1052/1369 [08:40<04:09,  1.27it/s]Processing batches:  78%|███████▊  | 1062/1369 [08:43<02:47,  1.83it/s]Processing batches:  78%|███████▊  | 1072/1369 [08:44<01:37,  3.05it/s]Processing batches:  79%|███████▊  | 1077/1369 [08:44<01:18,  3.70it/s]Processing batches:  79%|███████▉  | 1081/1369 [08:48<02:03,  2.33it/s]Processing batches:  80%|███████▉  | 1089/1369 [08:51<01:57,  2.38it/s]Processing batches:  80%|███████▉  | 1093/1369 [08:57<02:59,  1.54it/s]Processing batches:  80%|████████  | 1097/1369 [09:02<03:23,  1.34it/s]Processing batches:  81%|████████  | 1103/1369 [09:03<02:32,  1.74it/s]Processing batches:  81%|████████  | 1107/1369 [09:04<02:02,  2.14it/s]Processing batches:  82%|████████▏ | 1119/1369 [09:08<01:47,  2.32it/s]Processing batches:  82%|████████▏ | 1125/1369 [09:12<01:54,  2.14it/s]Processing batches:  82%|████████▏ | 1126/1369 [09:14<02:15,  1.80it/s]Processing batches:  83%|████████▎ | 1134/1369 [09:17<01:55,  2.03it/s]Processing batches:  84%|████████▍ | 1150/1369 [09:18<00:59,  3.67it/s]Processing batches:  84%|████████▍ | 1153/1369 [09:19<00:54,  3.95it/s]Processing batches:  84%|████████▍ | 1154/1369 [09:21<01:24,  2.54it/s]Processing batches:  84%|████████▍ | 1155/1369 [09:22<01:34,  2.26it/s]Processing batches:  85%|████████▍ | 1158/1369 [09:26<02:12,  1.59it/s]Processing batches:  85%|████████▍ | 1162/1369 [09:28<01:55,  1.80it/s]Processing batches:  85%|████████▌ | 1169/1369 [09:29<01:16,  2.61it/s]Processing batches:  86%|████████▌ | 1174/1369 [09:35<02:08,  1.51it/s]Processing batches:  87%|████████▋ | 1186/1369 [09:37<01:12,  2.51it/s]Processing batches:  87%|████████▋ | 1187/1369 [09:39<01:31,  1.99it/s]Processing batches:  87%|████████▋ | 1195/1369 [09:43<01:26,  2.01it/s]Processing batches:  87%|████████▋ | 1197/1369 [09:46<01:46,  1.61it/s]Processing batches:  88%|████████▊ | 1207/1369 [09:49<01:16,  2.11it/s]Processing batches:  89%|████████▉ | 1216/1369 [09:50<00:47,  3.20it/s]Processing batches:  89%|████████▉ | 1221/1369 [09:53<01:00,  2.45it/s]Processing batches:  89%|████████▉ | 1224/1369 [09:55<01:01,  2.38it/s]Processing batches:  90%|████████▉ | 1229/1369 [09:58<01:10,  1.99it/s]Processing batches:  90%|█████████ | 1238/1369 [09:58<00:39,  3.32it/s]Processing batches:  91%|█████████ | 1240/1369 [10:01<00:51,  2.53it/s]Processing batches:  91%|█████████ | 1242/1369 [10:03<01:03,  2.00it/s]Processing batches:  91%|█████████ | 1243/1369 [10:06<01:29,  1.40it/s]Processing batches:  91%|█████████ | 1244/1369 [10:09<02:12,  1.06s/it]Processing batches:  91%|█████████▏| 1251/1369 [10:11<01:12,  1.63it/s]Processing batches:  92%|█████████▏| 1262/1369 [10:16<00:54,  1.97it/s]Processing batches:  93%|█████████▎| 1269/1369 [10:20<00:52,  1.90it/s]Processing batches:  93%|█████████▎| 1275/1369 [10:24<00:56,  1.66it/s]Processing batches:  95%|█████████▍| 1294/1369 [10:29<00:30,  2.47it/s]Processing batches:  95%|█████████▍| 1298/1369 [10:30<00:25,  2.77it/s]Processing batches:  95%|█████████▌| 1301/1369 [10:33<00:30,  2.25it/s]Processing batches:  96%|█████████▌| 1308/1369 [10:37<00:31,  1.96it/s]Processing batches:  96%|█████████▌| 1311/1369 [10:39<00:29,  1.94it/s]Processing batches:  96%|█████████▌| 1317/1369 [10:44<00:32,  1.62it/s]Processing batches:  97%|█████████▋| 1333/1369 [10:45<00:11,  3.02it/s]Processing batches:  98%|█████████▊| 1339/1369 [10:48<00:10,  2.82it/s]Processing batches:  99%|█████████▊| 1350/1369 [10:48<00:04,  4.13it/s]Processing batches:  99%|█████████▉| 1352/1369 [10:50<00:05,  3.40it/s]Processing batches:  99%|█████████▉| 1357/1369 [10:51<00:03,  3.43it/s]Processing batches:  99%|█████████▉| 1359/1369 [10:52<00:02,  3.64it/s]Processing batches: 100%|█████████▉| 1366/1369 [10:53<00:00,  4.36it/s]Processing batches: 100%|██████████| 1369/1369 [10:53<00:00,  2.10it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:cell_eval._evaluator:Writing pred DE results to: rpe1_pred_de.csv
INFO:cell_eval._types._de:Checking DE data integrity... (real)
INFO:cell_eval._types._de:DE data integrity check complete. (real)
INFO:cell_eval._types._de:Checking DE data integrity... (pred)
INFO:cell_eval._types._de:DE data integrity check complete. (pred)
INFO:cell_eval._pipeline._runner:Computing metric 'overlap_at_N'
INFO:cell_eval._pipeline._runner:Computing metric 'overlap_at_50'
INFO:cell_eval._pipeline._runner:Computing metric 'overlap_at_100'
INFO:cell_eval._pipeline._runner:Computing metric 'overlap_at_200'
INFO:cell_eval._pipeline._runner:Computing metric 'overlap_at_500'
INFO:cell_eval._pipeline._runner:Computing metric 'precision_at_N'
INFO:cell_eval._pipeline._runner:Computing metric 'precision_at_50'
INFO:cell_eval._pipeline._runner:Computing metric 'precision_at_100'
INFO:cell_eval._pipeline._runner:Computing metric 'precision_at_200'
INFO:cell_eval._pipeline._runner:Computing metric 'precision_at_500'
INFO:cell_eval._pipeline._runner:Computing metric 'de_spearman_sig'
INFO:cell_eval._pipeline._runner:Computing metric 'de_direction_match'
INFO:cell_eval._pipeline._runner:Computing metric 'de_spearman_lfc_sig'
INFO:cell_eval._pipeline._runner:Computing metric 'de_sig_genes_recall'
INFO:cell_eval._pipeline._runner:Computing metric 'de_nsig_counts'
INFO:cell_eval._pipeline._runner:Computing metric 'pr_auc'
INFO:cell_eval._pipeline._runner:Computing metric 'roc_auc'
INFO:cell_eval._pipeline._runner:Computing metric 'pearson_delta'
INFO:cell_eval._types._anndata:Building pseudobulk embeddings for real anndata on: .X
INFO:cell_eval._types._anndata:Building pseudobulk embeddings for predicted anndata on: .X
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...:   4%|▍         | 16/421 [00:00<00:02, 158.05it/s]Iterating over perturbations...:  20%|██        | 85/421 [00:00<00:00, 466.25it/s]Iterating over perturbations...:  37%|███▋      | 156/421 [00:00<00:00, 573.45it/s]Iterating over perturbations...:  53%|█████▎    | 224/421 [00:00<00:00, 611.58it/s]Iterating over perturbations...:  70%|██████▉   | 293/421 [00:00<00:00, 638.04it/s]Iterating over perturbations...:  86%|████████▌ | 363/421 [00:00<00:00, 658.30it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 609.25it/s]
INFO:cell_eval._pipeline._runner:Computing metric 'mse'
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...:  18%|█▊        | 77/421 [00:00<00:00, 761.65it/s]Iterating over perturbations...:  37%|███▋      | 155/421 [00:00<00:00, 772.09it/s]Iterating over perturbations...:  55%|█████▌    | 233/421 [00:00<00:00, 758.87it/s]Iterating over perturbations...:  74%|███████▍  | 311/421 [00:00<00:00, 765.69it/s]Iterating over perturbations...:  92%|█████████▏| 388/421 [00:00<00:00, 748.88it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 755.99it/s]
INFO:cell_eval._pipeline._runner:Computing metric 'mae'
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...:  19%|█▊        | 78/421 [00:00<00:00, 776.30it/s]Iterating over perturbations...:  37%|███▋      | 156/421 [00:00<00:00, 776.43it/s]Iterating over perturbations...:  56%|█████▌    | 234/421 [00:00<00:00, 769.79it/s]Iterating over perturbations...:  74%|███████▍  | 312/421 [00:00<00:00, 772.49it/s]Iterating over perturbations...:  93%|█████████▎| 390/421 [00:00<00:00, 753.27it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 760.99it/s]
INFO:cell_eval._pipeline._runner:Computing metric 'mse_delta'
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...:  18%|█▊        | 76/421 [00:00<00:00, 751.75it/s]Iterating over perturbations...:  36%|███▌      | 152/421 [00:00<00:00, 749.32it/s]Iterating over perturbations...:  54%|█████▍    | 227/421 [00:00<00:00, 724.93it/s]Iterating over perturbations...:  72%|███████▏  | 302/421 [00:00<00:00, 731.59it/s]Iterating over perturbations...:  90%|████████▉ | 377/421 [00:00<00:00, 736.73it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 737.25it/s]
INFO:cell_eval._pipeline._runner:Computing metric 'mae_delta'
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...:  17%|█▋        | 73/421 [00:00<00:00, 720.41it/s]Iterating over perturbations...:  35%|███▌      | 148/421 [00:00<00:00, 732.72it/s]Iterating over perturbations...:  53%|█████▎    | 223/421 [00:00<00:00, 736.82it/s]Iterating over perturbations...:  71%|███████   | 298/421 [00:00<00:00, 739.01it/s]Iterating over perturbations...:  88%|████████▊ | 372/421 [00:00<00:00, 731.16it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 734.11it/s]
INFO:cell_eval._pipeline._runner:Computing metric 'discrimination_score_l1'
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 7348.75it/s]
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 6744.41it/s]
INFO:cell_eval._pipeline._runner:Computing metric 'discrimination_score_l2'
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 7274.67it/s]
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 6029.55it/s]
INFO:cell_eval._pipeline._runner:Computing metric 'discrimination_score_cosine'
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 7120.40it/s]
Iterating over perturbations...:   0%|          | 0/421 [00:00<?, ?it/s]Iterating over perturbations...: 100%|██████████| 421/421 [00:00<00:00, 6166.56it/s]
INFO:cell_eval._evaluator:Writing perturbation level metrics to /work/home/cryoem666/czx/project/state_training_debug/experiment/ba_loss_01_13/model_output/rpe1/0.7_0.3/eval_best.ckpt/rpe1_results.csv
INFO:cell_eval._evaluator:Writing aggregate metrics to /work/home/cryoem666/czx/project/state_training_debug/experiment/ba_loss_01_13/model_output/rpe1/0.7_0.3/eval_best.ckpt/rpe1_agg_results.csv
